Note, however, that in some situations the content that is written to `document.write` includes some surrounding context that you need to take account of in your exploit.
**Example** - 
you might need to close some existing elements before using your JavaScript payload.

## Steps to solve lab
### Title - DOM XSS in `document.write` sink using source `location.search` inside a select element
**Desc** - This lab contains a [[DOM-based_XSS]] vulnerability in the stock checker functionality. It uses the JavaScript `document.write` function, which writes data out to the page. The `document.write` function is called with data from `location.search` which you can control using the website URL. The data is enclosed within a select element.

**Our end goal** - To solve this lab, perform a [[DOM-based_XSS]] attack that breaks out of the select element and calls the `alert` function.

1. After analyzing the dom, we get to know that there is one more parameter in `window.location`(web page url) which is `storeId`.
![[XSS7.png]]

2. Now, **to test for DOM XSS**: to check if this vulnerability exists, use a random alphanumeric string (like "abc123") as the value of the `storeId` in `window.location` which is web page url.
![[XSS8.png]]

3. You then examine the context in which your string appears. In this case, it appears inside a select element and we know that from the lab description that it tell us that "to solve the lab, perform a [[DOM-based_XSS]] attack that breaks out of the select element and calls the `alert` function".
4. Now, our payload that breaks the "select" element is shown below:
```js
&storeId=abc123</select> <img src="1" onerror="alert(1)">
```
It just closes the "select" element and inserted a new image element and with a fake url that obviously give us error, it help us to execute "alert" function.

![[XSS9.png]]

