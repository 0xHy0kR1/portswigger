In principle, a website is vulnerable to DOM-based cross-site scripting if there is an executable path via which data can propagate from source to [[sinks]].

There are a variety of sinks that are relevant to DOM-based vulnerabilities. Please refer to the [[DOM-based_XSS_list]] below for details.

**The `document.write` sink works with `script` elements, so you can use a simple payload, such as the one below:**
```js
document.write('... <script>alert(document.domain)</script> ...');
```

## Steps to solve lab - 
### title - DOM XSS in `document.write` sink using source `location.search`
**Desc** - This lab contains a [[DOM-based_XSS]] vulnerability in the search query tracking functionality. It uses the JavaScript `document.write` function, which writes data out to the page. The `document.write` function is called with data from `location.search`, which you can control using the website URL.

**Our end goal** - To solve this lab, perform a XSS attack that calls the `alert` function.

1. To check if this vulnerability exists, use a random alphanumeric string (like "abc123") as the search term.
![[XSS4.png]]

2. Using the browser's developer tools, you look at the HTML code of the search results page to find where your string ("abc123") appears.
![[XSS5.png]]

3. You then examine the context in which your string appears. For instance, is it within a double-quoted attribute like `<input value="abc123">`?
   
4. Based on the context, you modify your input to test if you can inject malicious code. For example, you might try `"abc123"` to see if you can break out of the attribute.

5. Now, try to use the below payload for "DOM-based XSS" in the search box or as a url query.
```js
abc123" onload="alert()
```
![[XSS6.png]]

## Related labs -
--> [[(lab-2)Exploiting_DOM_XSS_with_different_sources_and_sinks]]