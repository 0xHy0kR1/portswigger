Some WebSockets vulnerabilities can only be found and exploited by manipulating the WebSocket handshake. These vulnerabilities tend to involve design flaws, Design flaws in the context of WebSocket vulnerabilities refer to problems or mistakes in how the WebSocket communication is set up and managed. These issues can make the WebSocket system vulnerable to attacks. Here are some common design flaws explained simply:

1. **Misplaced Trust in HTTP Headers**: 
	- This means that sometimes WebSocket systems trust certain information in the HTTP headers too much. 
	- For example, they might rely on a header called "X-Forwarded-For" to make important security decisions. But if this header can be manipulated or faked by an attacker, it can lead to security problems.

2. **Flaws in Session Handling:**
	- WebSocket messages are often handled within a session, which is like a user's interaction with a web application. If there are problems with how these sessions are managed, it can create vulnerabilities.
	- Imagine if someone could mess with the session context during the WebSocket handshake; they might gain unauthorized access or control.

3. **Attack Surface with Custom HTTP Headers:**
	- Some applications use their own custom HTTP headers (additional information sent with requests). If these custom headers aren't properly secured or validated, they can open up opportunities for attackers to exploit weaknesses in the WebSocket system.


## Steps to solve lab
### Title - Manipulating the WebSocket handshake to exploit vulnerabilities

**Desc** - This online shop has a live chat feature implemented using WebSockets. It has an aggressive but flawed XSS filter. To solve the lab, use a WebSocket message to trigger an `alert()` popup in the support agent's browser.

1. 