# Pre-requisite --> [[Blind_SSRF_with_out-of-band_detection]]
## Introduction
- Simply identifying a blind SSRF vulnerability that can trigger out-of-band HTTP requests doesn't in itself provide a route to exploitability. Since you cannot view the response from the back-end request, the behavior can't be used to explore content on systems that the application server can reach.
- The "Referer" header can be used to find weaknesses in a server or its connected systems.
- Hackers can scan the server's internal IP addresses to look for vulnerabilities.
- They send specific data to detect well-known weaknesses.
- If they use sneaky techniques, they might find a critical vulnerability on an unpatched server.

## Steps to solve lab
### Desc - Blind SSRF with Shellshock exploitation
**Our end goal** - 
This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.
To solve the lab, use this functionality to perform a [blind SSRF](https://portswigger.net/web-security/ssrf/blind) attack against an internal server in the `192.168.0.X` range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user.

1. First install "collaborator Everywhere" extension in burp, so that you can automatically get to see which part have blind vulnerability.
2. Now, add the url to scope to find blind vulnerability using "collaborator everywhere" extension.
![[SSRF26.png]]

3. From step 2, we know "User-Agent" header and "Referer" header is vulnerable to blind vulnerability. So, send the "/Product" page to Repeater.
![[SSRF27.png]]

4. Now, set the value of "User-Agent" header to "ShellShock" payload and set the value of "Referer" header to `192.168.0.X` range on port 8080 as it is given in the lab description.
![[SSRF28.png]]
As you can see above, there is no such DNS query to our burp collaborator server because we don't which system is vulnerable to "ShellShock" payload. 

5. Now, we are going to send the above request to intruder to find vulnerable system in the internal ip.
Intruder setting - 
**Positions** - 
![[SSRF29.png]]

**Payloads** - 
![[SSRF30.png]]
Now, start the attack.

6. After the attack, in the "Collaborator" tab click on "Poll now" and you get the DNS lookup query and from their just copy paste the os user as a solution.
![[SSRF31.png]]

**Source for ShellShock payload** - https://blog.cloudflare.com/inside-shellshock/